<!-- Generated by SpecStory -->

# Debugging Python Web Scraper with Selenium and Requests (2025-10-10 03:09:54Z)

<!-- Claude Code Session 0f6d67e3-526a-483c-9a7c-3cf4d8ecd0b6 (2025-10-10_03-09-54Z) -->

_**User**_

Analyze these staged git changes and output ONLY a single-line conventional commit message (type(scope): description). No explanations.
diff --git a/src/components/cloud-storage/CatalogFilters.tsx b/src/components/cloud-storage/CatalogFilters.tsx
index 1042454..06445d1 100644
--- a/src/components/cloud-storage/CatalogFilters.tsx
+++ b/src/components/cloud-storage/CatalogFilters.tsx
@@ -209,6 +209,17 @@ export const CatalogFilters: React.FC<CatalogFiltersProps> = ({
     });
   };
 
+  /**
+   * Handle liked only toggle
+   */
+  const handleLikedToggle = (checked: boolean) => {
+    onChange({
+      ...filters,
+      showLikedOnly: checked || undefined,
+      page: 1, // Reset to first page
+    });
+  };
+
   /**
    * Handle items per page change
    */
@@ -242,6 +253,7 @@ export const CatalogFilters: React.FC<CatalogFiltersProps> = ({
     if (filters.category) count++;
     if (filters.tags && filters.tags.length > 0) count++;
     if (filters.isFeatured) count++;
+    if (filters.showLikedOnly) count++;
     return count;
   }, [filters]);
 
@@ -375,6 +387,18 @@ export const CatalogFilters: React.FC<CatalogFiltersProps> = ({
         />
       </div>
 
+      {/* Liked Only Toggle */}
+      <div className="flex items-center justify-between space-x-2">
+        <Label htmlFor="liked-only" className="cursor-pointer">
+          Show Liked Only
+        </Label>
+        <Switch
+          id="liked-only"
+          checked={filters.showLikedOnly || false}
+          onCheckedChange={handleLikedToggle}
+        />
+      </div>
+
       {/* Items Per Page */}
       <div className="space-y-2">
         <Label htmlFor="limit">Items Per Page</Label>
diff --git a/src/pages/Library.tsx b/src/pages/Library.tsx
index 2c3d0a0..ee462c7 100644
--- a/src/pages/Library.tsx
+++ b/src/pages/Library.tsx
@@ -4,6 +4,8 @@ import { Button } from "@/components/ui/button";
 import { Badge } from "@/components/ui/badge";
 import { Input } from "@/components/ui/input";
 import { Skeleton } from "@/components/ui/skeleton";
+import { Label } from "@/components/ui/label";
+import { Switch } from "@/components/ui/switch";
 import {
   Search,
   Grid,
@@ -16,7 +18,8 @@ import {
   RefreshCw,
   SortAsc,
   SortDesc,
-  Calendar
+  Calendar,
+  Heart
 } from "lucide-react";
 import { motion } from "framer-motion";
 import { useMyModes } from "@/hooks/use-cloud-modes";
@@ -40,6 +43,7 @@ const Library = () => {
   const [viewMode, setViewMode] = useState<"grid" | "list">("grid");
   const [searchQuery, setSearchQuery] = useState("");
   const [sortBy, setSortBy] = useState<SortOption>("recent");
+  const [showLikedOnly, setShowLikedOnly] = useState(false);
 
   // Filter and sort modes based on search query and sort option
   const filteredAndSortedModes = useMemo(() => {
@@ -47,6 +51,11 @@ const Library = () => {
 
     let result = [...modes];
 
+    // Apply liked filter
+    if (showLikedOnly) {
+      result = result.filter((mode) => mode.userLiked === true);
+    }
+
     // Apply search filter
     if (searchQuery.trim()) {
       const query = searchQuery.toLowerCase();
@@ -80,7 +89,7 @@ const Library = () => {
     });
 
     return result;
-  }, [modes, searchQuery, sortBy]);
+  }, [modes, searchQuery, sortBy, showLikedOnly]);
 
   // Handle loading mode into editor
   const handleLoadMode = (mode: any) => {
@@ -269,6 +278,19 @@ const Library = () => {
         </div>
 
         <div className="flex items-center space-x-2">
+          {/* Show Liked Only toggle */}
+          <div className="flex items-center space-x-2 px-3 py-2 border border-border rounded-lg">
+            <Heart className={`w-4 h-4 ${showLikedOnly ? 'fill-current text-primary' : 'text-muted-foreground'}`} />
+            <Label htmlFor="liked-only" className="cursor-pointer text-sm">
+              Liked
+            </Label>
+            <Switch
+              id="liked-only"
+              checked={showLikedOnly}
+              onCheckedChange={setShowLikedOnly}
+            />
+          </div>
+
           {/* Sort selector */}
           <Select value={sortBy} onValueChange={(value) => setSortBy(value as SortOption)}>
             <SelectTrigger className="w-40">
diff --git a/src/services/cloud-mode-service.ts b/src/services/cloud-mode-service.ts
index 717a110..10105f6 100644
--- a/src/services/cloud-mode-service.ts
+++ b/src/services/cloud-mode-service.ts
@@ -204,7 +204,7 @@ export interface ICloudModeService {
   /**
    * Get public modes with pagination and filters
    */
-  getPublicModes(options: PaginationOptions): Promise<PaginatedResponse<CloudMode>>;
+  getPublicModes(options: ModeFilters): Promise<PaginatedResponse<CloudMode>>;
 
   /**
    * Like a mode (toggle)
@@ -355,7 +355,7 @@ export class CloudModeService implements ICloudModeService {
       .from('modes')
       .select('*')
       .eq('author_id', userId)
-      .order('modified_at', { ascending: false });
+      .order('modified_at', { ascending: false});
 
     if (modesError) {
       throw new Error(`Failed to fetch user modes: ${modesError.message}`);
@@ -368,11 +368,29 @@ export class CloudModeService implements ICloudModeService {
       .eq('id', userId)
       .single();
 
-    // Merge profile data into modes
-    return (modesData || []).map((row) => this.toCloudMode({
-      ...row,
-      user_profiles: profileData || null,
-    } as any));
+    // Fetch all likes for current user for these modes
+    const modeIds = (modesData || []).map(mode => mode.id);
+    const { data: likesData } = await this.supabase
+      .from('mode_likes')
+      .select('mode_id')
+      .eq('user_id', userId)
+      .in('mode_id', modeIds);
+
+    // Create a set of liked mode IDs for quick lookup
+    const likedModeIds = new Set((likesData || []).map(like => like.mode_id));
+
+    // Merge profile data and like status into modes
+    return (modesData || []).map((row) => {
+      const cloudMode = this.toCloudMode({
+        ...row,
+        user_profiles: profileData || null,
+      } as any);
+
+      // Add userLiked field
+      cloudMode.userLiked = likedModeIds.has(row.id);
+
+      return cloudMode;
+    });
   }
 
   /**
@@ -523,13 +541,13 @@ export class CloudModeService implements ICloudModeService {
   /**
    * Get public modes with pagination and filters
    *
-   * @param options - Pagination options
+   * @param options - Filter and pagination options
    * @returns Paginated response with cloud modes
    */
   async getPublicModes(
-    options: PaginationOptions = {}
+    options: ModeFilters = {}
   ): Promise<PaginatedResponse<CloudMode>> {
-    const { page = 1, limit = 20, sort = 'recent' } = options;
+    const { page = 1, limit = 20, sort = 'recent', showLikedOnly } = options;
 
     let query = this.supabase
       .from('modes')
@@ -578,26 +596,56 @@ export class CloudModeService implements ICloudModeService {
       (profilesData || []).map(profile => [profile.id, profile])
     );
 
-    // Merge profile data into modes
-    const modesWithProfiles = (modesData || []).map(row => {
+    // Fetch current user's likes for these modes (if authenticated)
+    let likedModeIds = new Set<string>();
+    try {
+      const userId = await this.getCurrentUserId();
+      const modeIds = (modesData || []).map(mode => mode.id);
+      const { data: likesData } = await this.supabase
+        .from('mode_likes')
+        .select('mode_id')
+        .eq('user_id', userId)
+        .in('mode_id', modeIds);
+
+      likedModeIds = new Set((likesData || []).map(like => like.mode_id));
+    } catch {
+      // User not authenticated, skip likes fetching
+    }
+
+    // Merge profile data and like status into modes
+    let modesWithProfiles = (modesData || []).map(row => {
       const profile = profilesMap.get(row.author_id);
-      return this.toCloudMode({
+      const cloudMode = this.toCloudMode({
         ...row,
         user_profiles: profile ? {
           screen_name: profile.screen_name,
           avatar_url: profile.avatar_url,
         } : null,
       } as any);
+
+      // Add userLiked field
+      cloudMode.userLiked = likedModeIds.has(row.id);
+
+      return cloudMode;
     });
 
+    // Apply liked-only filter if requested
+    if (showLikedOnly) {
+      modesWithProfiles = modesWithProfiles.filter(mode => mode.userLiked === true);
+    }
+
+    // Recalculate pagination after filtering
+    const filteredTotal = modesWithProfiles.length;
+    const filteredTotalPages = Math.ceil(filteredTotal / limit);
+
     return {
       data: modesWithProfiles,
       pagination: {
         page,
         limit,
-        total,
-        totalPages,
-        hasNext: page < totalPages,
+        total: filteredTotal,
+        totalPages: filteredTotalPages,
+        hasNext: page < filteredTotalPages,
         hasPrev: page > 1,
       },
     };
diff --git a/src/types/cloud-mode.ts b/src/types/cloud-mode.ts
index 6f768e3..925561a 100644
--- a/src/types/cloud-mode.ts
+++ b/src/types/cloud-mode.ts
@@ -379,6 +379,9 @@ export interface ModeFilters {
   /** Filter featured modes only */
   isFeatured?: boolean;
 
+  /** Show only modes liked by current user */
+  showLikedOnly?: boolean;
+
   /** Sort order */
   sort?: ModeSortOption;
 


---

_**Agent (claude-sonnet-4-5-20250929)**_

feat(library): add liked-only filter to mode browsing

